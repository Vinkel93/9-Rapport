\section{PI controller}
\label{pressure_control}

As described in \secref{control_problem} the two PMA pumps should generate a constant differential pressure. Furthermore \secref{control_problem} concludes that a simple PI controller, reacting to a reference calculated by the MPC, should be used to control the pressure generated by the main pumps. 

In \appref{cha:linear_pump2} a linearized pump model is derived. With the operating point of the four pumps and their respective parameters shown in \appref{system_description}, four different models are derived, and given as: 
\vspace{-0.5cm}
\begin{equation*}
  \begin{minipage}[b]{0.25\textwidth}
  \begin{equation*}
  	\begin{split}
  		G_{C2}(s) &= 0.966
  	\end{split}
  \end{equation*}
  \end{minipage}
  \begin{minipage}[b]{0.25\textwidth}
  \begin{equation*}
  	\begin{split}
  		G_{C16}(s) &= 0.976
  	\end{split}
  \end{equation*}

  \end{minipage}
  \begin{minipage}[b]{0.25\textwidth}
  \begin{equation*}
  	\begin{split}
  		G_{C18}(s) &= 0.217
  	\end{split}
  \end{equation*}
  \end{minipage}
  \begin{minipage}[b]{0.25\textwidth}
  \begin{equation*}
  	\begin{split}
  		G_{C25}(s) &= 0.546
  	\end{split}
  \end{equation*}
  \end{minipage}
\end{equation*}

The controllers are design through the Matlab toolbox \textit{Control System Designer App}\citep{GSTWTCSD}, with the approach of the same control characteristics. Since the time constant of the water system is measured to be 1155 seconds, see \secref{sec:WT_TimeConstant}. The settling time of the PI controllers is chosen to be under 10 seconds, which is deemed sufficient. The steady state error and the overshoot should not exceed 5\% as this in the worst case will saturate the differential pressure sensors.

The controllers are designed as:
\begin{equation*}
  \begin{minipage}[b]{0.45\textwidth}
  \begin{equation*}
  	\begin{split}
  		PI_{c2} &= \frac{1.39s + 1.39}{s}\\
 		PI_{c16} &= \frac{1.39s + 1.39}{s}
  	\end{split}
  \end{equation*}
  \end{minipage}
  \begin{minipage}[b]{0.45\textwidth}
  \begin{equation*}
  	\begin{split}
  		PI_{c18} &= \frac{5.89s + 5.89}{s}\\
  		PI_{c25} &= \frac{2.57s + 2.57}{s}
  	\end{split}
  \end{equation*}
  \end{minipage}
\end{equation*}

From the design and test conducted in \appref{cha:linear_pump2}, it is shown that the controllers meet the desired requirements and thus can be implemented on the test setup. 


% For convenience the simple controller, that should be used for the PMA pumps, is also chosen as a PI controller. The two set of pumps are very similar, only deviating in a few parameters. Therefor only one of the controller will be explained in this section.  

